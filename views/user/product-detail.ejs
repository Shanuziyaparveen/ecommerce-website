<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
/* General Page Styles */
body {
  font-family: 'Arial', sans-serif;
  background-color: #f4f4f4;
  color: #333;
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  flex-direction: column;
  text-align: center;
}

/* Page Header */
.page-header {
  background-color: #fff;
  padding: 15px 20px;
  width: 100%;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  text-align: center;
}

.page-header .breadcrumb {
  display: flex;
  justify-content: center;
  gap: 10px;
  font-size: 14px;
}

.page-header .breadcrumb a {
  color: #0073e6;
  text-decoration: none;
}

.page-header .breadcrumb a:hover {
  text-decoration: underline;
}

.page-header .breadcrumb span {
  color: #999;
}

/* Product Details Section */
.product-details {
  display: flex;
  flex-wrap: wrap;
  gap: 30px;
  padding: 40px 20px;
  background-color: #fff;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  max-width: 1200px;
  width: 100%;
  margin-top: 20px;
  justify-content: center;
}

/* Image Section */
.image-section {
  width: 40%;
  max-width: 500px;
  text-align: center;
}

.main-image-container {
  width: 100%;
  position: relative;
  overflow: hidden;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
}

.main-image-container img {
  width: 100%;
  border-radius: 10px;
  transition: transform 0.3s ease-in-out;
}

.main-image-container img:hover {
  transform: scale(1.05);
}

.thumbnails-container {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  justify-content: center;
}

.thumbnail {
  width: 60px;
  height: 60px;
  object-fit: cover;
  border-radius: 5px;
  cursor: pointer;
  transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
}

.thumbnail:hover {
  opacity: 0.8;
  transform: scale(1.1);
}

/* Details Section */
.details-section {
  flex: 1;
  color: #333;
  max-width: 55%;
}

.details-section h1 {
  font-size: 2rem;
  margin-bottom: 15px;
  font-weight: bold;
  text-transform: capitalize;
}

.price {
  font-size: 1.6rem;
  color: #ff5722;
  font-weight: bold;
}

.original-price {
  text-decoration: line-through;
  color: #999;
  margin-left: 10px;
  font-size: 1.4rem;
}

.coupon {
  background-color: #28a745;
  padding: 8px 12px;
  border-radius: 5px;
  font-size: 1rem;
  margin-top: 10px;
  display: inline-block;
}

.rating {
  font-size: 1.2rem;
  margin-top: 10px;
}

.stock {
  margin-top: 10px;
  font-size: 1rem;
}

.in-stock {
  color: #28a745;
}

.out-of-stock {
  color: #dc3545;
}

h3 {
  margin-top: 20px;
  font-size: 1.6rem;
  color: #333;
  border-bottom: 2px solid #0073e6;
  padding-bottom: 10px;
  text-transform: uppercase;
  font-weight: 500;
}

/* Product Highlights */
ul {
  list-style: none;
  padding: 0;
}

ul li {
  font-size: 1rem;
  margin-bottom: 8px;
  padding-left: 20px;
  position: relative;
}

ul li:before {
  content: "✔";
  position: absolute;
  left: 0;
  color: #28a745;
}

/* Add to Cart Button */
.add-to-cart-btn {
  background-color: #0073e6;
  color: #fff;
  border: none;
  padding: 12px 24px;
  border-radius: 6px;
  font-size: 1.2rem;
  cursor: pointer;
  margin-top: 20px;
  transition: background-color 0.3s ease, transform 0.3s ease;
}

.add-to-cart-btn:hover {
  background-color: #005bb5;
  transform: scale(1.05);
}

/* Footer Section */
.footer {
  background-color:  #f4f4f4;
  padding: 40px 0;
  font-family: Arial, sans-serif;
}

.footer .container {
  max-width: 1200px;
  margin: 0 auto;
}

.footer__about, .footer__widget {
  margin-bottom: 30px;
}

.footer__logo img {
  max-width: 150px;
}

.footer__about p {
  font-size: 14px;
  color: #666;
  margin: 20px 0;
}

.footer__widget h6 {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 15px;
}

.footer__widget ul {
  list-style: none;
  padding: 0;
}

.footer__widget ul li {
  margin-bottom: 10px;
}

.footer__widget ul li a {
  text-decoration: none;
  color: #333;
  font-size: 14px;
}

.footer__widget ul li a:hover {
  color: #007bff;
}

.footer__newsletter input {
  width: 70%;
  padding: 10px;
  border: 1px solid #ddd;
  border-radius: 5px;
  font-size: 14px;
}

.footer__newsletter button {
  padding: 10px 15px;
  background-color: #007bff;
  border: none;
  border-radius: 5px;
  color: white;
  cursor: pointer;
}

.footer__newsletter button:hover {
  background-color: #0056b3;
}

.footer__copyright__text {
  font-size: 14px;
  color: #666;
  padding-top: 20px;
}

.footer__copyright__text a {
  color: #007bff;
  text-decoration: none;
}

.footer__copyright__text a:hover {
  text-decoration: underline;
}

/* Responsive Design */
@media (max-width: 768px) {
  .footer .container {
    padding: 0 15px;
  }
  
  .footer__about, .footer__widget {
    margin-bottom: 20px;
    text-align: center;
  }

  .footer__about p {
    font-size: 12px;
  }

  .footer__newsletter input {
    width: 60%;
  }

  .footer__newsletter button {
    padding: 8px 12px;
  }

  .footer__widget ul li a {
    font-size: 12px;
  }
}


</style>
<body>
  

<main class="main">
  <div class="container">
    <div class="page-header breadcrumb-wrap">
      <div class="breadcrumb">
        <a href="/" rel="nofollow">Home</a>
        <span>&gt;</span>
        <a href="/getAllProducts" rel="nofollow">Shop</a>
        <span>&gt;</span>
        <a href="/product/<%= product._id %>" rel="nofollow" disabled><%= product.productName %></a>
      </div>
    </div>

    <section>
      <div class="product-details">
        <!-- Image Section -->
        <div class="image-section">
          <!-- Main Image -->
          <div class="main-image-container">
            <img id="main-image" src="<%= product.productImage.length > 0 ? '/uploads/product-images/' + product.productImage[0] : '/uploads/product-images/default-thumbnail.jpg' %>" alt="<%= product.productName %>" />
          </div>

          <!-- Thumbnails -->
          <div class="thumbnails-container">
            <% if (Array.isArray(product.productImage) && product.productImage.length > 0) { %>
              <% product.productImage.forEach(img => { %>
                <img class="thumbnail" src="/uploads/product-images/<%= img || 'default-thumbnail.jpg' %>" alt="Thumbnail"
                onclick="document.getElementById('main-image').src='/uploads/product-images/<%= img || 'default-thumbnail.jpg' %>'" />
              <% }) %>
            <% } else { %>
              <p>No images available</p>
            <% } %>
          </div>
        </div>

        <!-- Details Section -->
        <div class="details-section">
          <h1><%= product.productName %></h1>

          <!-- Price -->
          <p class="price">
            ₹<%= product.salePrice %>
            <% if (product.regularPrice > product.salePrice) { %>
              <span class="original-price">₹<%= product.regularPrice %></span>
            <% } %>
          </p>

          <!-- Discount Coupon -->
          <% if (product.coupon) { %>
            <p class="coupon">Discount: <%= product.coupon %></p>
          <% } %>

          <!-- Rating -->
          <p class="rating">Rating: <%= product.rating %> ⭐</p>

         

          <!-- Product Highlights -->
          <h3>Product Highlights</h3>
          <ul>
            <li><%= product.description %></li>
          </ul>
          <p class="stock">
            <span id="stock-status" class="<%= product.isBlocked || product.quantity === 0 ? 'out-of-stock' : 'in-stock' %>">
              <%= product.stockMessage %>
            </span>
          </p>
          
          <!-- Add to Cart Button -->
          <div>
            <% if (product.quantity === 0 || product.isBlocked) { %>
              <button class="add-to-cart-btn disabled" disabled>Notify when restocks</button>
            <% } else { %>
              <button data-product-id="<%= product._id %>" class="add-to-cart-btn" onclick="addToCart('<%= product._id %>')">Add to Cart</button>
            <% } %>
          </div>
          

          <!-- Related Products Section -->
          <h3>Related Products</h3>
          <div class="related-products">
            <% if (relatedProducts && relatedProducts.length > 0) { %>
              <% relatedProducts.forEach(related => { %>
                <div class="related-product-card">
                  <a href="/product/<%= related._id %>">
                    <img src="<%= related.productImage[0] %>" alt="<%= related.productName %>" />
                    <h4><%= related.productName %></h4>
                    <p>₹<%= related.salePrice %></p>
                  </a>
                </div>
              <% }) %>
            <% } else { %>
              <p>No related products found.</p>
            <% } %>
          </div>
        </div>
      </div>
    </section>
  </div>
</main>
<!-- Footer Section -->
<footer class="footer">
  <div class="container">
    <div class="row">
      <!-- About Section -->
      <div class="col-lg-3 col-md-6 col-sm-6 footer__about">
        <div class="footer__logo">
          <a href="#"><img src="/img/logo.png" alt="Logo"></a>
        </div>
        <p>The customer is at the heart of our unique business model, which includes design.</p>
        <a href="#"><img src="/img/payment.png" alt="Payment Methods"></a>
      </div>

    

      <!-- Customer Service Section -->
      <div class="col-lg-2 col-md-3 col-sm-6 footer__widget">
        <h6>Customer Service</h6>
        <ul>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">Returns & Exchanges</a></li>
        </ul>
      </div>

      <!-- Newsletter Section -->
      <div class="col-lg-3 col-md-6 col-sm-6 footer__widget">
        <h6>Newsletter</h6>
        <div class="footer__newsletter">
          <p>Be the first to know about new arrivals, lookbooks, sales & promos!</p>
          <form action="#">
            <input type="email" placeholder="Your email">
            <button type="submit"><span class="icon_mail_alt"></span>Subscribe</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Copyright Section -->
    <div class="row">
      <div class="col-lg-12 text-center footer__copyright__text">
        <p>Copyright © <script>document.write(new Date().getFullYear());</script> 2024. All rights reserved | This template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a></p>
      </div>
    </div>
  </div>
</footer>
<!-- Footer Section End -->

  <!-- JavaScript for Image Zoom -->
  <script>
   const mainImage = document.getElementById('main-image');
  
  // Add zoom effect when hovering over the image
  mainImage.addEventListener('mousemove', function (e) {
    const zoomLevel = 2;
    const rect = e.target.getBoundingClientRect();
    const x = ((e.clientX - rect.left) / rect.width) * 100;
    const y = ((e.clientY - rect.top) / rect.height) * 100;
    e.target.style.transform = `scale(${zoomLevel})`;
    e.target.style.transformOrigin = `${x}% ${y}%`;
  });

  // Reset zoom when mouse leaves the image
  mainImage.addEventListener('mouseleave', function () {
    this.style.transform = 'scale(1)';
    this.style.transformOrigin = 'center';
  });

  
  // Get all the stars
  const stars = document.querySelectorAll('#star-rating .fa-star');
  
  // Handle click events on stars
  stars.forEach(star => {
    star.addEventListener('click', () => {
      const rating = star.getAttribute('data-rating') || stars.indexOf(star) + 1;
      
      // Remove 'selected' class from all stars
      stars.forEach(s => s.classList.remove('selected'));
      
      // Add 'selected' class to clicked star and all stars before it
      for (let i = 0; i < rating; i++) {
        stars[i].classList.add('selected');
      }
      
      // Optionally, save the rating in a hidden input field (or handle it on form submission)
      document.getElementById('rating-value').value = rating;
    });
  });
  document.addEventListener('DOMContentLoaded', () => {
    console.log("DOM fully loaded and parsed");
    const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');

    addToCartButtons.forEach(button => {
        console.log("Button found:", button);
        button.addEventListener('click', async () => {
            console.log("Add to Cart button clicked");

            const productId = button.getAttribute('data-product-id');
            console.log("Product ID:", productId);
            
            const isLoggedIn = <%= JSON.stringify(user ? true : false) %>;
            if (!isLoggedIn) {
                Swal.fire({
                    title: 'Login required!',
                    text: 'You need to be logged in to add products to your cart.',
                    icon: 'warning',
                    confirmButtonText: 'Login'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = '/login';
                    }
                });
                return;
            }

            try {
                const response = await fetch('/addToCart', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ productId }),
                });

                const result = await response.json();
                console.log("Response:", result);

                if (response.ok && result.success) {
                    Swal.fire({
                        title: 'Product added to cart!',
                        icon: 'success',
                        showConfirmButton: false,
                        timer: 1500
                    });
                } else {
                    Swal.fire({
                        title: 'Error',
                        text: result.message || 'Unable to add product to the cart.',
                        icon: 'error',
                        confirmButtonText: 'Okay'
                    });
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
                Swal.fire({
                    title: 'Error',
                    text: 'An unexpected error occurred. Please try again.',
                    icon: 'error',
                    confirmButtonText: 'Okay'
                });
            }
        });
    });
});


</script>
</body>

  



</html>



